<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G/S Battle Simulator: Final Polish v2</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>

    <div id="game-container">
        <div id="game-boy">
            <div id="lcd-overlay"></div>
            <div id="streak-box" class="hidden">WINS: 0</div>

            <!-- Start Screen -->
            <div id="start-screen">
                <div class="start-title">POKEMON<br>GOLD & SILVER<br>SIMULATION</div>
                <div class="start-btn" onclick="Game.checkSave()">CLICK TO START</div>
                <div class="toggle-box" onclick="Game.toggleLcd()">
                    <div class="checkbox" id="lcd-check"></div>
                    <span>RETRO FILTER</span>
                </div>
                <!-- NEW: Retro Motion Toggle -->
                <div class="toggle-box" onclick="Game.toggleRetroMotion()">
                    <div class="checkbox" id="motion-check"></div>
                    <span>RETRO MOTION</span>
                </div>
                <div style="font-size: 6px; color: #888; margin-top: 20px;">Z: CONFIRM | X: BACK | ARROWS: MOVE</div>
            </div>

            <!-- Name Input Screen -->
            <div id="name-screen" class="hidden">
                <div style="margin-bottom: 10px;">REGISTRATION</div>
                <div style="font-size: 8px; margin-bottom: 20px;">PLEASE ENTER YOUR NAME</div>
                <input type="text" id="name-input" maxlength="8" placeholder="NAME">
                <div class="start-btn" onclick="Game.confirmName()">CONFIRM</div>
            </div>

            <!-- CONTINUE SCREEN -->
            <div id="continue-screen" class="hidden">
                <div class="cont-menu-box">
                    <div class="cont-opt" id="opt-continue" onclick="Game.loadGame()">CONTINUE</div>
                    <div class="cont-opt" id="opt-newgame" onclick="Game.startNameInput()">NEW GAME</div>
                </div>
                <div class="save-info-box">
                    <div class="save-row" style="color:yellow" id="save-name">PLAYER</div>
                    <div class="save-row"><span>WINS</span> <span id="save-wins">0</span></div>
                    <div class="save-row"><span>BOSSES</span> <span id="save-bosses">0</span></div>
                    <div class="save-row" style="margin-top:4px;">PARTY</div>
                    <div class="party-preview-row" id="save-preview"></div>
                    <div style="font-size:6px; text-align:center; color:#888;">CLICK PKMN FOR INFO</div>
                </div>
            </div>

            <!-- Summary Screen -->
            <div id="summary-panel" class="hidden">
                <div class="sum-header">
                    <div style="font-weight: bold; font-size: 10px;" id="sum-name">NAME</div>
                    <div id="sum-shiny-icon" style="color:gold; font-size:10px; display:none;">✦</div>
                    <div id="sum-status-text" style="font-size:8px;">STATUS/OK</div>
                </div>
                <div class="sum-body">
                    <div class="sum-sprite"><img id="sum-sprite-img" src=""></div>
                    <div class="sum-data">
                        <div id="sum-types"></div>
                        <div style="margin-top:4px;">HP <span id="sum-hp-txt"></span></div>
                        <div class="sum-stat-bar">
                            <div class="sum-stat-fill" id="sum-hp-bar" style="background:var(--hp-green);"></div>
                        </div>
                        <div>EXP <span id="sum-exp-txt"></span></div>
                        <div class="sum-stat-bar">
                            <div class="sum-stat-fill" id="sum-exp-bar" style="background:var(--xp-blue);"></div>
                        </div>

                        <div class="sum-divider"></div>

                        <div id="summary-stats"></div>
                    </div>
                </div>
                <div style="font-size:8px; font-weight:bold; margin-bottom:2px;">MOVES:</div>
                <div id="summary-moves" class="sum-moves"></div>
                <div class="sum-buttons">
                    <button class="confirm-btn nav-btn" id="btn-prev" onclick="Game.navSummary(-1)">&lt;</button>
                    <button class="confirm-btn" id="btn-action">ACTION</button>
                    <button class="confirm-btn secondary" id="btn-back-sum" onclick="Game.closeSummary()">CLOSE</button>
                    <button class="confirm-btn nav-btn" id="btn-next" onclick="Game.navSummary(1)">&gt;</button>
                </div>
            </div>

            <!-- Party Screen -->
            <div id="party-screen" class="hidden">
                <div class="party-header" id="party-header-text">POKEMON PARTY</div>
                <div id="party-list" class="party-list"></div>
                <div id="party-context" class="hidden"></div>
                <div class="btn-bar" id="party-close-btn" onclick="Battle.uiToMenu()">CLOSE</div>
            </div>

            <!-- Pack Screen -->
            <div id="pack-screen" class="hidden">
                <div class="pack-header">ITEM POCKET</div>
                <div class="pack-body">
                    <div class="pack-graphic">
                        <div class="bag-icon"></div>
                    </div>
                    <div class="pack-list" id="pack-list"></div>
                </div>
                <div class="pack-desc-box" id="pack-desc">Choose an item.</div>
            </div>

            <!-- RETRO SELECTION SCREEN -->
            <div id="selection-screen" class="hidden">
                <div class="sel-preview-box">
                    <img id="sel-preview-img" class="preview-sprite" src="" style="display:none">
                    <div id="sel-preview-shiny" class="shiny-mark">✦</div>
                </div>
                <div class="lab-table-area">
                    <div class="table-graphic" id="lab-table">
                        <div class="sel-cursor" id="sel-cursor"></div>
                    </div>
                </div>
                <div class="sel-desc-box" id="sel-text-box">SELECT A POKEMON</div>
            </div>

            <!-- Battle Scene -->
            <div class="scene hidden" id="scene">
                <div id="fx-container"
                    style="position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none;"></div>

                <!-- ENEMY HUD -->
                <div class="hud" id="enemy-hud">
                    <div class="name">
                        <span id="enemy-name">LOADING...</span>
                        <!-- Pre-baked empty icons for Status and Rage -->
                        <span id="enemy-status-icon"
                            style="font-size:8px; font-weight:bold; margin-left:4px; text-shadow:1px 1px 0 #fff; display:none;"></span>
                        <span id="enemy-rage-icon" class="aggro-icon" style="display:none;"></span>
                    </div>
                    <div class="level" id="enemy-lvl">Lv15</div>
                    <div class="hp-box">
                        <span style="margin-right:2px; color:#e6ae27;">HP</span>
                        <div class="hp-bar-bg">
                            <div id="enemy-hp-bar" class="hp-fill"></div>
                        </div>
                    </div>
                </div>

                <img id="enemy-sprite" class="sprite" src="" alt="Enemy">
                <img id="player-sprite" class="sprite" src="" alt="Player">

                <!-- PLAYER HUD -->
                <div class="hud" id="player-hud">
                    <div class="name">
                        <span id="player-name">LOADING...</span>
                        <!-- Pre-baked empty icons for Status and Rage -->
                        <span id="player-status-icon"
                            style="font-size:8px; font-weight:bold; margin-left:4px; text-shadow:1px 1px 0 #fff; display:none;"></span>
                        <span id="player-rage-icon" class="aggro-icon" style="display:none;"></span>
                    </div>
                    <div class="level" id="player-lvl">Lv15</div>
                    <div class="hp-box">
                        <span style="margin-right:2px; color:#e6ae27;">HP</span>
                        <div class="hp-bar-bg">
                            <div id="player-hp-bar" class="hp-fill"></div>
                        </div>
                    </div>
                    <div id="player-hp-text">--/--</div>
                    <div class="exp-box">
                        <span style="font-size:6px; margin-right:1px;">EXP</span>
                        <div class="exp-bar-bg">
                            <div id="player-exp-bar" class="exp-fill"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dialog Box -->
            <div id="dialog-box" class="hidden">
                <div id="text-content">...</div>
                <div id="action-menu" class="hidden">
                    <div class="menu-item" id="opt-fight" onclick="Battle.uiToMoves()">FIGHT</div>
                    <div class="menu-item" id="opt-pkmn" onclick="Game.openParty(false)">PKMN</div>
                    <div class="menu-item" id="opt-pack" onclick="Battle.openPack()">PACK</div>
                    <div class="menu-item" id="opt-run" onclick="Battle.askRun()">RUN</div>
                </div>
                <div id="move-menu" class="hidden"></div>
            </div>
        </div>
    </div>


    <!-- Extracted Modules -->
    <script src="js/utils.js"></script>

    <!-- Data & Config -->
    <script src="js/data/constants.js"></script>
    <script src="js/data/settings.js"></script>
    <script src="js/data/moves.js"></script>
    <script src="js/data/items.js"></script>

    <script src="js/audio.js"></script>
    <script src="js/api.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/input.js"></script>
    <script src="js/encounter.js"></script>


    <!-- Extracted Logic Engines -->
    <script src="js/game.js"></script>
    <script src="js/battle.js"></script>

    <script>
        // --- INITIALIZATION ---
        Input.init();
        Input.setMode("START");
    </script>
</body>

</html>